rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Fonction pour vérifier l'authentification
    function isAuthenticated() {
      return request.auth != null;
    }
    
    // ✅ USERS - Lecture pour tous les authentifiés
    match /users/{userId} {
      allow read: if isAuthenticated();
      allow create: if isAuthenticated();
      allow update: if isAuthenticated();
      allow delete: if isAuthenticated();
    }
    
    // ✅ INTERVENTIONS - Accès complet
    match /interventions/{interventionId} {
      allow read, write: if isAuthenticated();
    }
    
    // ✅ BLOCKED ROOMS - Accès complet
    match /blockedRooms/{roomId} {
      allow read, write: if isAuthenticated();
    }
    
    // ✅ DROPDOWNS - Accès complet
    match /dropdowns/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    match /dropdownOptions/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    match /adminOptions/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    match /adminData/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    // ✅ SETTINGS
    match /settings/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    // ✅ NOTIFICATIONS
    match /notifications/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    // ✅ FCM TOKENS
    match /fcmTokens/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    // ✅ ANALYTICS
    match /analytics/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    // ✅ AUDIT LOGS
    match /auditLogs/{document=**} {
      allow read, write: if isAuthenticated();
    }
    
    // ✅ CATCH-ALL - Tout ce qui n'est pas listé ci-dessus
    match /{document=**} {
      allow read, write: if isAuthenticated();
    }
  }
}